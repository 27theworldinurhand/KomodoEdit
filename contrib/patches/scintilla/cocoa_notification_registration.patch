Turn the cocoa notification handler into a list, instead of having just one
handler. This is because in SciMoz we use this method to setup and listen for
notification events, in order to pass back to DOM listeners, but ScintillaView
also registers a handler in order to deal with certain events.
Index: /Users/toddw/as/komodo-devel_play/src/scintilla/cocoa/ScintillaCocoa.h
--- cocoa/ScintillaCocoa.h
+++ cocoa/ScintillaCocoa.h (unsaved)
@@ -100,6 +100,7 @@
   NSEvent* lastMouseEvent;
 
   id<ScintillaNotificationProtocol> delegate;
+  id<ScintillaNotificationProtocol> scimozDelegate;
 
   SciNotifyFunc	notifyProc;
   intptr_t notifyObj;
@@ -143,6 +144,7 @@
   virtual ~ScintillaCocoa();
 
   void SetDelegate(id<ScintillaNotificationProtocol> delegate_);
+  void SetScimozDelegate(id<ScintillaNotificationProtocol> delegate_);
   void RegisterNotifyCallback(intptr_t windowid, SciNotifyFunc callback);
   sptr_t WndProc(unsigned int iMessage, uptr_t wParam, sptr_t lParam);
 
Index: /Users/toddw/as/komodo-devel_play/src/scintilla/cocoa/ScintillaCocoa.mm
--- cocoa/ScintillaCocoa.mm
+++ cocoa/ScintillaCocoa.mm (unsaved)
@@ -385,6 +385,7 @@
   timerTarget = [[TimerTarget alloc] init: this];
   lastMouseEvent = NULL;
   delegate = NULL;
+  scimozDelegate = NULL;
   notifyObj = NULL;
   notifyProc = NULL;
   capturedMouse = false;
@@ -1811,6 +1812,10 @@
 {
   delegate = delegate_;
 }
+void ScintillaCocoa::SetScimozDelegate(id<ScintillaNotificationProtocol> delegate_)
+{
+  scimozDelegate = delegate_;
+}
 
 //--------------------------------------------------------------------------------------------------
 
@@ -1863,6 +1868,8 @@
   scn.nmhdr.idFrom = GetCtrlID();
   if (delegate)
     [delegate notification:&scn];
+  if (scimozDelegate)
+    [scimozDelegate notification:&scn];
 }
 
 //--------------------------------------------------------------------------------------------------
Index: /Users/toddw/as/komodo-devel_play/src/scintilla/cocoa/ScintillaView.h
--- cocoa/ScintillaView.h
+++ cocoa/ScintillaView.h (unsaved)
@@ -112,10 +112,12 @@
   BOOL mInfoBarAtTop;
 
   id<ScintillaNotificationProtocol> mDelegate;
+  id<ScintillaNotificationProtocol> mScimozDelegate;
 }
 
 @property (nonatomic, readonly) Scintilla::ScintillaCocoa* backend;
 @property (nonatomic, assign) id<ScintillaNotificationProtocol> delegate;
+@property (nonatomic, assign) id<ScintillaNotificationProtocol> scimozDelegate;
 @property (nonatomic, readonly) NSScrollView *scrollView;
 
 + (Class) contentViewClass;
Index: /Users/toddw/as/komodo-devel_play/src/scintilla/cocoa/ScintillaView.mm
--- cocoa/ScintillaView.mm
+++ cocoa/ScintillaView.mm (unsaved)
@@ -902,6 +902,7 @@
 
 @synthesize backend = mBackend;
 @synthesize delegate = mDelegate;
+@synthesize scimozDelegate = mScimozDelegate;
 @synthesize scrollView;
 
 /**
@@ -1040,6 +1041,10 @@
 {
   // Parent notification. Details are passed as SCNotification structure.
 
+  if (mScimozDelegate != nil)
+  {
+    [mScimozDelegate notification: scn];
+  }
   if (mDelegate != nil)
   {
     [mDelegate notification: scn];
